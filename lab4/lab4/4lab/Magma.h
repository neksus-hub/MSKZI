#pragma once
#include <cmath>
#include <iostream>
#include <stdlib.h>
using namespace std;

class Magma
{
private:
    uint8_t S[8][16] = {
        { 0xC, 0x4, 0x6, 0x2, 0xA, 0x5, 0xB, 0x9, 0xE, 0x8, 0xD, 0x7, 0x0, 0x3, 0xF, 0x1 },
        { 0x6, 0x8, 0x2, 0x3, 0x9, 0xA, 0x5, 0xC, 0x1, 0xE, 0x4, 0x7, 0xB, 0xD, 0x0, 0xF },
        { 0xB, 0x3, 0x5, 0x8, 0x2, 0xF, 0xA, 0xD, 0xE, 0x1, 0x7, 0x4, 0xC, 0x9, 0x6, 0x0 },
        { 0xC, 0x8, 0x2, 0x1, 0xD, 0x4, 0xF, 0x6, 0x7, 0x0, 0xA, 0x5, 0x3, 0xE, 0x9, 0xB },
        { 0x7, 0xF, 0x5, 0xA, 0x8, 0x1, 0x6, 0xD, 0x0, 0x9, 0x3, 0xE, 0xB, 0x4, 0x2, 0xC },
        { 0x5, 0xD, 0xF, 0x6, 0x9, 0x2, 0xC, 0xA, 0xB, 0x7, 0x8, 0x1, 0x4, 0x3, 0xE, 0x0 },
        { 0x8, 0xE, 0x2, 0x5, 0x6, 0x9, 0x1, 0xC, 0xF, 0x4, 0xB, 0x0, 0xD, 0xA, 0x3, 0x7 },
        { 0x1, 0x7, 0xE, 0xD, 0x0, 0x5, 0x8, 0x3, 0x4, 0xF, 0xA, 0x6, 0x9, 0xC, 0xB, 0x2 },
    };
    uint64_t deployed_key[4];
    uint32_t divided_key[8];
    uint32_t a1 = 0;
    uint32_t a0 = 0;
    uint32_t a0_ = 0;

public:
    Magma();
    void Deploy_key_into_4(uint64_t key_56);
    void Divide_deployed_key_into_8();
//    void Print_bits(uint64_t bits);
    void Next_round(int round_num, bool flag_round);
    uint64_t EncryptDecrypt_block(uint64_t block, bool encrypt);
    //    Crypt();
    //    EnCrypt();
};